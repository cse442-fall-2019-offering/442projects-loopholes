{"ast":null,"code":"import { firebaseStorage } from \"./index\";\nimport * as Endpoint from \"../constants/Endpoint\";\n/**\n * upload a single image to firebaseStorage\n */\n\nexport default class ImageUploader {\n  /**\n   * @param imageFile the image file to be uploaded to firebase storage\n   * double check that it is an image.\n   * @param fileName please pass in a timestamp as a string followed by\n   * an image format such as 20191007201031.jpg.\n   */\n  constructor(imageFile, fileName, eventTitle, eventDate, eventTime, eventLocation) {\n    this.imageFile = \"\";\n    this.fileName = \"\";\n    this.imageURL = \"\";\n    this.eventTitle = \"\";\n    this.eventDate = \"\";\n    this.eventTime = \"\";\n    this.eventLocation = \"\";\n\n    this.sendImageToFirebaseStorage = async () => {\n      try {\n        const uploadTask = await firebaseStorage.ref(\"Images/\".concat(this.fileName)).put(this.imageFile);\n        const downloadURL = await uploadTask.ref.getDownloadURL();\n        this.imageURL = downloadURL;\n        fetch(process.env.REACT_APP_BACKEND_API + Endpoint.UPLOAD_IMAGE_METADATA, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            image_link: this.imageURL,\n            event_title: this.eventTitle,\n            event_date: this.eventDate,\n            event_time: this.eventTime,\n            event_location: this.eventLocation\n          })\n        });\n        alert(\"Image successfully uploaded, please return to the homepage to view it!\");\n      } catch (error) {\n        console.log(\"Unable to upload file: \" + this.fileName + \"\\n\" + error);\n        alert(\"Uploading image failed!\");\n      }\n    };\n\n    this.getImageDownloadURL = () => {\n      return this.imageURL;\n    };\n\n    this.imageFile = imageFile;\n    this.fileName = fileName;\n    this.eventTitle = eventTitle;\n    this.eventDate = eventDate;\n    this.eventTime = eventTime;\n    this.eventLocation = eventLocation;\n  }\n\n}","map":{"version":3,"sources":["/Users/kaibus/Fall19/CSE442/UBulletinMain/UBulletin/442projects-loopholes/Frontend/src/firebase/ImageUploader.js"],"names":["firebaseStorage","Endpoint","ImageUploader","constructor","imageFile","fileName","eventTitle","eventDate","eventTime","eventLocation","imageURL","sendImageToFirebaseStorage","uploadTask","ref","put","downloadURL","getDownloadURL","fetch","process","env","REACT_APP_BACKEND_API","UPLOAD_IMAGE_METADATA","method","headers","body","JSON","stringify","image_link","event_title","event_date","event_time","event_location","alert","error","console","log","getImageDownloadURL"],"mappings":"AAAA,SAASA,eAAT,QAAgC,SAAhC;AACA,OAAO,KAAKC,QAAZ,MAA0B,uBAA1B;AAEA;;;;AAGA,eAAe,MAAMC,aAAN,CAAoB;AASjC;;;;;;AAMAC,EAAAA,WAAW,CACTC,SADS,EAETC,QAFS,EAGTC,UAHS,EAITC,SAJS,EAKTC,SALS,EAMTC,aANS,EAOT;AAAA,SArBFL,SAqBE,GArBU,EAqBV;AAAA,SApBFC,QAoBE,GApBS,EAoBT;AAAA,SAnBFK,QAmBE,GAnBS,EAmBT;AAAA,SAlBFJ,UAkBE,GAlBW,EAkBX;AAAA,SAjBFC,SAiBE,GAjBU,EAiBV;AAAA,SAhBFC,SAgBE,GAhBU,EAgBV;AAAA,SAfFC,aAeE,GAfc,EAed;;AAAA,SASFE,0BATE,GAS2B,YAAY;AACvC,UAAI;AACF,cAAMC,UAAU,GAAG,MAAMZ,eAAe,CACrCa,GADsB,kBACR,KAAKR,QADG,GAEtBS,GAFsB,CAElB,KAAKV,SAFa,CAAzB;AAGA,cAAMW,WAAW,GAAG,MAAMH,UAAU,CAACC,GAAX,CAAeG,cAAf,EAA1B;AACA,aAAKN,QAAL,GAAgBK,WAAhB;AACAE,QAAAA,KAAK,CACHC,OAAO,CAACC,GAAR,CAAYC,qBAAZ,GAAoCnB,QAAQ,CAACoB,qBAD1C,EAEH;AACEC,UAAAA,MAAM,EAAE,MADV;AAEEC,UAAAA,OAAO,EAAE;AAAE,4BAAgB;AAAlB,WAFX;AAGEC,UAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBC,YAAAA,UAAU,EAAE,KAAKjB,QADE;AAEnBkB,YAAAA,WAAW,EAAE,KAAKtB,UAFC;AAGnBuB,YAAAA,UAAU,EAAE,KAAKtB,SAHE;AAInBuB,YAAAA,UAAU,EAAE,KAAKtB,SAJE;AAKnBuB,YAAAA,cAAc,EAAE,KAAKtB;AALF,WAAf;AAHR,SAFG,CAAL;AAcAuB,QAAAA,KAAK,CACH,wEADG,CAAL;AAGD,OAvBD,CAuBE,OAAOC,KAAP,EAAc;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAY,4BAA4B,KAAK9B,QAAjC,GAA4C,IAA5C,GAAmD4B,KAA/D;AACAD,QAAAA,KAAK,CAAC,yBAAD,CAAL;AACD;AACF,KArCC;;AAAA,SA0CFI,mBA1CE,GA0CoB,MAAM;AAC1B,aAAO,KAAK1B,QAAZ;AACD,KA5CC;;AACA,SAAKN,SAAL,GAAiBA,SAAjB;AACA,SAAKC,QAAL,GAAgBA,QAAhB;AACA,SAAKC,UAAL,GAAkBA,UAAlB;AACA,SAAKC,SAAL,GAAiBA,SAAjB;AACA,SAAKC,SAAL,GAAiBA,SAAjB;AACA,SAAKC,aAAL,GAAqBA,aAArB;AACD;;AA7BgC","sourcesContent":["import { firebaseStorage } from \"./index\";\nimport * as Endpoint from \"../constants/Endpoint\";\n\n/**\n * upload a single image to firebaseStorage\n */\nexport default class ImageUploader {\n  imageFile = \"\";\n  fileName = \"\";\n  imageURL = \"\";\n  eventTitle = \"\";\n  eventDate = \"\";\n  eventTime = \"\";\n  eventLocation = \"\";\n\n  /**\n   * @param imageFile the image file to be uploaded to firebase storage\n   * double check that it is an image.\n   * @param fileName please pass in a timestamp as a string followed by\n   * an image format such as 20191007201031.jpg.\n   */\n  constructor(\n    imageFile,\n    fileName,\n    eventTitle,\n    eventDate,\n    eventTime,\n    eventLocation\n  ) {\n    this.imageFile = imageFile;\n    this.fileName = fileName;\n    this.eventTitle = eventTitle;\n    this.eventDate = eventDate;\n    this.eventTime = eventTime;\n    this.eventLocation = eventLocation;\n  }\n\n  sendImageToFirebaseStorage = async () => {\n    try {\n      const uploadTask = await firebaseStorage\n        .ref(`Images/${this.fileName}`)\n        .put(this.imageFile);\n      const downloadURL = await uploadTask.ref.getDownloadURL();\n      this.imageURL = downloadURL;\n      fetch(\n        process.env.REACT_APP_BACKEND_API + Endpoint.UPLOAD_IMAGE_METADATA,\n        {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            image_link: this.imageURL,\n            event_title: this.eventTitle,\n            event_date: this.eventDate,\n            event_time: this.eventTime,\n            event_location: this.eventLocation\n          })\n        }\n      );\n      alert(\n        \"Image successfully uploaded, please return to the homepage to view it!\"\n      );\n    } catch (error) {\n      console.log(\"Unable to upload file: \" + this.fileName + \"\\n\" + error);\n      alert(\"Uploading image failed!\");\n    }\n  };\n\n  /** @return a link to the image on firebase that will be stored in the\n   * image metadata.\n   */\n  getImageDownloadURL = () => {\n    return this.imageURL;\n  };\n}\n"]},"metadata":{},"sourceType":"module"}